# 文件哈希计算工具

## 简介
本工具是一个简单的桌面应用程序，用于计算文件或文件夹中所有文件的哈希值，并将结果保存到 SQLite 数据库中。它支持多种哈希算法，包括 MD5、CRC32、SHA - 256 和 SHA - 512。

[英文版](./README.md)

## 功能概述
本工具具备以下主要功能：
1. **多算法支持**：支持 MD5、CRC32、SHA - 256 和 SHA - 512 哈希算法。
2. **文件和文件夹处理**：可以处理单个文件或整个文件夹。
3. **文件锁定检查**：在计算哈希值之前，会检查文件是否正在被写入或更改，如果是则跳过该文件。
4. **进度显示**：在处理文件夹时，会显示处理进度。
5. **结果保存**：将计算得到的哈希值和写入时间保存到 SQLite 数据库中。

## 界面说明
### 多选框
- **MD5**：勾选后将计算文件的 MD5 哈希值。
- **CRC32**：勾选后将计算文件的 CRC32 哈希值。
- **SHA - 256**：勾选后将计算文件的 SHA - 256 哈希值。
- **SHA - 512**：勾选后将计算文件的 SHA - 512 哈希值。

### 选择路径区域
- **浏览按钮**：点击后可以选择要处理的文件或文件夹路径。
- **文本框**：用于输入或显示选择的文件或文件夹路径。

### 选择保存路径区域
- **浏览按钮**：点击后可以选择保存数据库的路径。
- **文本框**：用于输入或显示保存数据库的路径。

### 完成按钮
点击后开始计算文件的哈希值，并将结果保存到指定的数据库中。该按钮只有在至少勾选一个哈希算法，并且选择了文件或文件夹路径以及数据库保存路径后才会启用。

### 进度条
在处理文件夹时，会显示处理进度。

## 使用方法
### 选择哈希算法
根据需要勾选相应的哈希算法多选框。

### 选择文件或文件夹路径
点击“浏览”按钮，选择要处理的文件或文件夹。

### 选择数据库保存路径
点击“浏览”按钮，选择保存数据库的路径。

### 开始计算
点击“完成”按钮，工具将开始计算文件的哈希值，并将结果保存到指定的数据库中。计算完成后，会弹出消息框显示计算结果。

## 技术细节
### 依赖库
本工具使用了以下 Python 库：
- `os`：用于文件和路径操作。
- `hashlib`：用于计算哈希值。
- `zlib`：用于计算 CRC32 哈希值。
- `sqlite3`：用于创建和操作 SQLite 数据库。
- `wx`：用于创建图形用户界面（GUI）。
- `datetime`：用于记录写入时间。
- `psutil`：未在代码中实际使用，可能为预留库。
- `threading`：用于多线程处理，避免界面卡顿。
- `ctypes`：用于检查用户是否具有管理员权限。
- `sys`：用于获取命令行参数。

### 代码结构
- `is_file_locked`：检查文件是否被锁定（正在被写入或更改）。
- `calculate_hash`：根据指定的算法计算文件的哈希值。
- `process_files`：处理文件或文件夹，计算哈希值并保存到数据库中。
- `HashCalculatorGUI`：图形用户界面类，包含界面元素和事件处理方法。
- `is_admin`：检查用户是否具有管理员权限。

## 注意事项
- 请确保具有足够的权限访问要处理的文件或文件夹以及保存数据库的路径。
- 如果文件正在被写入或更改，工具将跳过该文件的哈希计算。

希望本说明文档能帮助你更好地使用本工具。如有任何问题或建议，请随时反馈。